第四章 对象与类

4.1  OOP 概述
1.类 (class)是构造对象的模板或蓝图。 
2.封装(encapsulation, 有时称为数据隐藏)是与对象有关的一个重要概念。 从形式上看， 封装不过是将数据和行为组合在一个包中， 并对对象的使用者隐藏了数据的实现方式。对象 中的数据称为实例域(instancefield), 操纵数据的过程称为方法(method) 对于每个特定的 类实例(对象)都有一组特定的实例域值。这些值的集合就是这个对象的当前状态(state)。 无论何时， 只要向对象发送一个消息， 它的状态就有可能发生改变。 
实现封装的关键在于绝对不能让类中的方法直接地访问其他类的实例域。 程序仅通过对 象的方法与对象数据进行交互。 
3．识别类
识别类的简单规则是在分析问题的过程中寻找名词， 而方法对应着动词。 
4.2	使用预定义类
4.3用户自定义类
1.文件名必须与 public 类的名字相匹配。 在一个 源文件中， 只能有一个公有类， 但可以有任意数目的非公有类。 
2.类通常包括类型属于某个类类型的实例域。 
3.构造器：
构造器与类同名 
•每个类可以有一个以上的构造器 
•构造器可以有 0 个、1 个或多个参数 
•构造器没有返回值 
•构造器总是伴随着 new 操作一起调用 
4.不要在构造器中定义与实例域重名的局部变量。 
5.Java 中，所有的方法都必须在类的内部定义， 但并不表示它们是内联方法。是否 将某个方法设置为内联方法是 Java 虚拟机的任务。 即时编译器会监视调用那些简洁、经 常被调用、没有被重载以及可优化的方法。 
6.需要获得或设置实例域的值。 因此， 应该提供下面三项内容: 
•一 私有的数据域; 
一 公有的域访问器方法; 
•一个公有的域更改器方法。 
7.注意不要编写返回引用可变对象的访问器方法。 
8.如果需要返回一个可变数据域的拷贝， 就应该使用 clone。 
9.以将实例域定义为 final 构建对象时必须初始化这样的域。也就是说， 必须确保在每 一个构造器执行之后， 这个域的值被设置， 并且在后面的操作中， 不能够再对它进行修改。 
4．4 静态域与静态方法
1.静态域：如果将域定义为 static , 每个类中只有一个这样的域。 而每一个对象对于所有的实例域 却都有自己的一份拷贝。 
2.静态方法是一种不能向?象?施操作的方法。 
3.Employee类的静态方法不能访问Id例域， 因为他不能操作对象。但是，静态方法可可以访问自身类中的静态域。 
4.在下面两种情况下使用静态方法:
•一 方法不需要访问对象状态， 其所需参数都是通过显式参数提供(例如: Math.pow ) 0
一个方法只需要访问类的静态域(例如: Employee.getNextldh 
5.static: 属于 类且不属于类对象的变量和函数。 这个含义与 Java 相同。 
6.需要注意，不需要使用对象调用静态方法。例如， 不需要构造 Math 类对象就可以调用 Math.pow。 
7.每一个类可以有一个 main 方法。这是一个常用于对类进行单元测试的技巧。 
4.5方法参数
1.Java 程序设计语言总是采用按值调用。 也就是说，方法得到的是所有参数值的一个拷贝，特别是，方法不能修改传递给它的任何参数变量的内容。 
2.Java 中方法参数的使用情况: 
•一个方法不能修改一个基本数据类型的参数 (即数值型或布尔型)。 
•一个方法可以改变一个对象参数的状态。 
•一个方法不能让对象参数引用一个新的对象。 
4.6 对象构造
1.重载：Java 允许重载任何方法，而不只是构造器方法。因此，要完整地描述一个方法，需要指出方法名以及参数类型。 
2.如果在构造器中没有显式地给域赋予初值， 那么就会被自动地赋为默认值: 数值为 0、 布尔值为 false、 对象引用为 nul。l 然而， 只有缺少程序设计经验的人才会这样做。 
3. 如果类中提供了至少一个构造器， 但是没有提供无参数的构造器， 则在构造对象时如果 没有提供参数就会被视为不合法。 
4.如果构造器的第一个语句形如 this(...)， 这个构造器将调用同一个类的另一个构造器。 
5.初始化块 ：初始化块(initializationblock )。 在一个类的声明中， 可以包含多个代码块。只要构造类的对象， 这些块就会被执行。 
6.下面是调 用构造器的具体处理步骤: 
1 ) 所有数据域被初始化为默认值(0、 false 或 null 。)
2 ) 按照在类声明中出现的次序， 依次执行所有域初始化语句和初始化块。 
3 ) 如果构造器第一行调用了第二个构造器， 则执行第二个构造器主体
4 ) 执行这个构造器的主体.
7.静态初始化块：
如果对类的静态域进行初始化的代码比较复杂，那么可以使用静态的初始化块。 
 在类第一次加载的时候， 将会进行静态域的初始化。与实例域一样，除非将它们显式地 设置成其他值，否则默认的初始值是 0、 false 或 null 所有的静态初始化语句以及静态初始 化块都将依照类定义的顺序执行。 
8.可以为任何一个类添加 finalize 方法。finalize 方法将在垃圾回收器清除对象之前调用。 在实际应用中， 不要依赖于使用 finalize 方法回收任何短缺的资源， 这是因为很难知道这个 方法什么时候才能够调用。 
4.7 包
1.Java 允许使用包 ( package > 将类组织起来。 借助于包可以方便地组织自己的代码， 并将 自己的代码与别人提供的代码库分开管理。 使用包的主要原因是确保类名的唯一性。 
2.一个类可以使用所属包中的所有类， 以及其他包中的公有类(public class。) 
3.只能使用星号(*) 导入一个包， 而不能使用 import java.* 或 import java.*.* 导入以 java 为前缀的所有包。 
4.import 语句不仅可以导人类， 还增加了导人静态方法和静态域的功能。 
5.要想将一个类放人包中， 就必须将包的名字放在源文件的开头， 包中定义类的代码之 前。 
4.8 类路径
1.为了使类能够被多个程序共享， 需要做到下面几点: 
1 ) 把类放到一个目录中 例如 /home/user/classdir 需要注意 这个目录是包树状结构 ，。， 
的基目录。 如果希望将 com.horstmann.corejava.Employee 类添加到其中， 这个 Employee.class 类文件就必须位于子目录 /home/user/classdir/com/horstmann/corejava 中。 
2 ) 将 JAR 文件放在一个目录中， 例如:/home/user/archives。
3 ) 设置类路径(classpath)。类路径是所有包含类文件的路径的集合。 

4.10 类设计技巧
1.一定要保证数据私有
2.一定要对数据初始化
3.不要再类中使用过多的基本类型
4.不是所有的域都需要独立的域访问器和域更改器
5.将职责过多的类进行分解
6.类名和方法名要能够体现他们的职责
命名类名的良好习惯是采用一个名词(Order)、 前面有形容词修饰的名词( RushOrder) 或动名词(有“ -ing”后缀)修饰名词(例如，BillingAddress)。对于方法来说，习惯是访问 器方法用小写 get 开头 ( getSalary ), 更改器方法用小写的 set 开头(setSalary ) 
7.优先使用不可变的类
更改对象的问题在于， 如果多个线程试图同时更新一个对象， 就会发生并发更改。其结 果是不可预料的。 如果类是不可变的， 就可以安全地在多个线程间共享其对象。 
因此，要尽可能让类是不可变的， 这是一个很好的想法。对于表示值的类， 如一个字符 串或一个时间点， 这尤其容易。 计算会生成新值， 而不是更新原来的值。 


